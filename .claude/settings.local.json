{
  "permissions": {
    "allow": [
      "Bash(tail:*)",
      "Bash(head:*)",
      "Bash(cd C:\\\\Users\\\\ReachElysium\\\\Documents\\\\JeffLoop:*)",
      "Bash(cd:*)",
      "Bash(grep:*)",
      "Bash(cd /c/Users/ReachElysium/Documents/JeffLoop && python << 'PYEOF'\nimport asyncio\nfrom datetime import datetime\nfrom decimal import Decimal\nfrom sqlalchemy import select\nfrom sqlalchemy.ext.asyncio import create_async_engine, AsyncSession\nfrom sqlalchemy.orm import sessionmaker\nfrom src.models.market_price import MarketPrice\nfrom src.models.base import Base\nfrom src.signals.generator import SignalGenerator\n\nasync def test\\(\\):\n    # Create test DB\n    engine = create_async_engine\\(\"sqlite+aiosqlite:///:memory:\"\\)\n    async with engine.begin\\(\\) as conn:\n        await conn.run_sync\\(MarketPrice.__table__.create\\)\n    \n    factory = sessionmaker\\(engine, class_=AsyncSession\\)\n    \n    # Add test data\n    async with factory\\(\\) as session:\n        session.add\\(MarketPrice\\(\n            card_id=\"sv1-test-001\",\n            source=\"justtcg\",\n            price_usd=Decimal\\(\"60.00\"\\),\n            price_eur=Decimal\\(\"54.00\"\\),\n            condition=\"NM\",\n            last_updated=datetime.utcnow\\(\\),\n        \\)\\)\n        await session.commit\\(\\)\n    \n    # Run generator\n    gen = SignalGenerator\\(factory\\)\n    signals = await gen.scan_for_signals\\(\\)\n    \n    print\\(f\"[SUCCESS] Generated {len\\(signals\\)} signals\"\\)\n    if signals:\n        s = signals[0]\n        print\\(f\"  Card: {s['card_id']}\"\\)\n        print\\(f\"  Profit: ${s['p_real']:.2f}\"\\)\n        print\\(f\"  Velocity: {s['velocity_tier']}\"\\)\n        print\\(f\"  Headache Tier: {s['headache_tier']}\"\\)\n        print\\(f\"  Has audit_snapshot: {'audit_snapshot' in s}\"\\)\n\nasyncio.run\\(test\\(\\)\\)\nPYEOF)",
      "Bash(cat:*)",
      "Bash(cd /c/Users/ReachElysium/Documents/JeffLoop && python << 'PYEOF'\nfrom datetime import date\nfrom decimal import Decimal\nfrom src.engine.maturity import calculate_maturity_decay, apply_maturity_penalty_with_reprint_rumor\nfrom src.engine.rotation import check_rotation_risk, get_mark_distance_from_current\n\n# Test maturity\ndecay = calculate_maturity_decay\\(date\\(2026, 2, 22\\), date\\(2026, 2, 22\\)\\)\nprint\\(f\"[OK] Maturity fresh set: {decay} == 1.0\"\\)\n\ndecay_with_rumor = apply_maturity_penalty_with_reprint_rumor\\(\n    Decimal\\(\"0.8\"\\), date\\(2026, 1, 1\\), True, date\\(2026, 2, 22\\)\n\\)\nprint\\(f\"[OK] Maturity with reprint penalty: {decay_with_rumor}\"\\)\n\n# Test rotation\nresult = check_rotation_risk\\(\"H\", \"Standard\", date\\(2026, 2, 22\\)\\)\nprint\\(f\"[OK] Rotation H mark: {result['risk_level']}\"\\)\n\nresult_g = check_rotation_risk\\(\"G\", \"Standard\", date\\(2026, 2, 22\\)\\)\nprint\\(f\"[OK] Rotation G mark today: {result_g['risk_level']} \\(days={result_g.get\\('days_until_rotation', 'N/A'\\)}\\)\"\\)\n\ndistance = get_mark_distance_from_current\\(\"G\"\\)\nprint\\(f\"[OK] Mark distance G: {distance}\"\\)\n\nprint\\(\"[OK] All imports and functions work!\"\\)\nPYEOF)",
      "Bash(cd /c/Users/ReachElysium/Documents/JeffLoop && python -m pytest tests/test_effective_price.py -v 2>&1)",
      "Bash(cd /c/Users/ReachElysium/Documents/JeffLoop && python -m pytest tests/test_trend.py -v 2>&1)",
      "Bash(cd /c/Users/ReachElysium/Documents/JeffLoop && python -m pytest tests/test_bundle.py -v 2>&1)",
      "Bash(cd /c/Users/ReachElysium/Documents/JeffLoop && python -c \"from src.models import Signal, SignalAudit; print\\(f'Signal table: {Signal.__tablename__}'\\); print\\(f'SignalAudit table: {SignalAudit.__tablename__}'\\); print\\('All imports OK'\\)\" 2>&1)",
      "Bash(cd \"C:\\\\Users\\\\ReachElysium\\\\Documents\\\\JeffLoop\" && python -m pytest tests/test_rotation_signals.py -v 2>&1)",
      "Bash(cd /c/Users/ReachElysium/Documents/JeffLoop && python -m pytest tests/test_cascade.py -v 2>&1)",
      "Bash(cd /c/Users/ReachElysium/Documents/JeffLoop && python -c \"from src.models import Signal, SignalAudit; from src.signals.cascade import should_cascade; from src.signals.rotation import score_candidates; from src.engine.bundle import calculate_seller_density_score; from src.engine.fees import calculate_platform_fees; from src.engine.trend import classify_trend; from src.engine.effective_price import calculate_effective_buy_price; from src.signals.deep_link import build_signal_urls; print\\('All imports OK'\\)\" 2>&1)",
      "Bash(cd /c/Users/ReachElysium/Documents/JeffLoop && python -c \"exec\\(open\\('alembic/versions/002_signals_schema.py'\\).read\\(\\)\\); print\\(f'revision: {revision}'\\); print\\(f'down_revision: {down_revision}'\\); print\\('Migration file syntactically valid'\\)\" 2>&1)",
      "Bash(cd \"C:\\\\Users\\\\ReachElysium\\\\Documents\\\\JeffLoop\" && python -m pytest tests/ -k forex -v 2>&1)",
      "Bash(cd \"C:\\\\Users\\\\ReachElysium\\\\Documents\\\\JeffLoop\" && python -m pytest tests/test_integration.py -v 2>&1)",
      "Bash(cd /c/Users/ReachElysium/Documents/JeffLoop && python -m pytest tests/ -v --tb=short 2>&1)",
      "Bash(test:*)",
      "Bash(cd \"C:\\\\Users\\\\ReachElysium\\\\Documents\\\\JeffLoop\" && python -m pytest tests/test_scheduler.py -v 2>&1)",
      "Bash(cd /c/Users/ReachElysium/Documents/JeffLoop && python -m pytest tests/test_price_trend.py -v 2>&1)",
      "Bash(cd \"C:\\\\Users\\\\ReachElysium\\\\Documents\\\\JeffLoop\" && python -m pytest tests/test_delivery.py -v 2>&1)",
      "Bash(cd /c/Users/ReachElysium/Documents/JeffLoop && python -m pytest tests/test_poketrace.py -v 2>&1)",
      "Bash(cd /c/Users/ReachElysium/Documents/JeffLoop && python -m pytest tests/test_scheduler.py -v 2>&1)",
      "Bash(cd \"C:\\\\Users\\\\ReachElysium\\\\Documents\\\\JeffLoop\" && python -m pytest tests/test_social_listener.py tests/test_limitless.py tests/test_synergy.py -v 2>&1)",
      "Bash(cd /c/Users/ReachElysium/Documents/JeffLoop && python -c \"from src.pipeline.poketrace import PokeTraceClient, PokeTraceVelocityData, PokeTraceCardResponse; from src.pipeline.scheduler import Scheduler; from src.signals.generator import SignalGenerator; print\\('All imports OK'\\)\" 2>&1)",
      "Bash(cd /c/Users/ReachElysium/Documents/JeffLoop && python -m pytest tests/test_scraper.py -v 2>&1)",
      "Bash(cd \"C:\\\\Users\\\\ReachElysium\\\\Documents\\\\JeffLoop\" && python -m pytest tests/ -v --tb=no -q 2>&1)",
      "Bash(cd /c/Users/ReachElysium/Documents/JeffLoop && python -m pytest tests/test_triggers.py -v 2>&1)",
      "Bash(cd /c/Users/ReachElysium/Documents/JeffLoop && python -m pytest tests/ --tb=short 2>&1)",
      "Bash(wc:*)"
    ]
  }
}
